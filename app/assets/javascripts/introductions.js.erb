/* スクロールでフェードイン */
/* 参考サイト: https://theorthodoxworks.com/web-design/scrollanimation/ */
$('.fade-in-down-wait').css('visibility','hidden');
$(window).scroll(function() {
  var windowHeight = $(window).height();
  var topWindow    = $(window).scrollTop();
  $('.fade-in-down-wait').each(function() {
    var targetPosition = $(this).offset().top;
    if (topWindow > targetPosition - windowHeight + 100){
     $(this).addClass("fade-in-down");
    }
  });
});

<%
  lab_persons = LaboPerson.all
  labs = Labo.all
  lab_persons_array = []

  lab_persons.each_slice(2) do |lab_man, lab_waman|
    lab_hash = {
                 lab_id: lab_man.labo_id,
                 lab_name: labs.find(lab_man.labo_id).get_english_name,
                 man: lab_man.number_of_people,
                 woman: lab_waman.number_of_people
               }
    lab_persons_array.push(lab_hash)
  end
%>

$(function() {

  const barGraphWidth = 28;

  $(".icons img").mouseover(function(){
    if($(this).hasClass("default_img")){
      $(this).hide();
      $(this).next().show();
    }
  }).mouseout(function(){
     if($(this).hasClass("mouseover_img")){
      $(this).hide();
      $(this).prev().show();
    }
  });

  let dataset = [
                  {"laboProfessor":"sumi", "man":15, "woman":2},
                  {"laboProfessor":"durst", "man":7, "woman":2},
                  {"laboProfessor":"sakuta", "man":13, "woman":1},
                  {"laboProfessor":"ohara", "man":17, "woman":0},
                  {"laboProfessor":"komiyama", "man":12, "woman":3},
                  {"laboProfessor":"tobe", "man":19, "woman":0},
                  {"laboProfessor":"harada", "man":15, "woman":5},
                  {"laboProfessor":"lopez", "man":16, "woman":5}
                ];

  for(let i = 0; i < dataset.length; i++){
    let d = dataset[i];
    let $genderRatioText = $("#gender_ratio_text_" + d.laboProfessor);
    let $genderRatioRect = $("#gender_ratio_rect_" + d.laboProfessor);
    let $svg = $(document.createElementNS("http://www.w3.org/2000/svg", "svg"));
    let $rectMan = $(document.createElementNS("http://www.w3.org/2000/svg", "rect"));
    let $rectWoman = $(document.createElementNS("http://www.w3.org/2000/svg", "rect"));
    let $width = $genderRatioRect.width();

    $genderRatioText.text("男女比 " + d.man + ":" + d.woman);
    $svg.attr({
      width: $width * (2 / 3),
      height: barGraphWidth
    });

    $rectMan.attr({
      width: $width * (d.man / (d.man + d.woman)) * (2 / 3),
      height: barGraphWidth,
      x: 0,
      y: 0,
      fill: "#A9D0F5"
    });

    $rectWoman.attr({
      width: $width * (d.woman / (d.man + d.woman)) * (2 / 3),
      height: barGraphWidth,
      x: $width * (d.man / (d.man + d.woman)) * (2 / 3),
      y: 0,
      fill: "#F5A9F2"
    });

    $svg.append($rectMan);
    $svg.append($rectWoman);
    $genderRatioRect.append($svg);
  }
});


/*フォントサイズや色の変更*/
//TODO css に
$(".comment_title").css('font-size', '20px');
$(".comment_list").find("p").css("font-size", "14px");


